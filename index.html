<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TR√ÄN B·ªò NH·ªö - Game Marketplace</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* --- CSS RESET & VARIABLES --- */
        :root {
            --bg-gradient-1: #87CEEB; 
            --bg-gradient-2: #E0F7FA; 
            --card-bg: rgba(255, 255, 255, 0.95);
            --text-color: #2c3e50;
            --primary-color: #00a8ff;
            --primary-dark: #0984e3;
            --accent-yellow: #fbc531;
            --accent-pink: #ff7675;
            --nav-bg: rgba(255, 255, 255, 0.9); 
            --font-main: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        
        body {
            color: var(--text-color);
            font-family: var(--font-main);
            line-height: 1.6;
            overflow-x: hidden;
            min-height: 100vh;
            background-color: #87CEEB;
            background: linear-gradient(180deg, var(--bg-gradient-1) 0%, var(--bg-gradient-2) 100%);
        }

        /* --- NAVBAR STYLES --- */
        .navbar {
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            padding: 15px 30px;
            background: var(--nav-bg); 
            backdrop-filter: blur(10px); 
            position: sticky; 
            top: 0;
            z-index: 1000; 
            box-shadow: 0 4px 15px rgba(0,0,0,0.1); 
            border-bottom: 1px solid rgba(255,255,255,0.5);
        }

        .logo {
            font-size: 1.5rem; 
            font-weight: 900; 
            color: var(--primary-color); 
            text-transform: uppercase;
            letter-spacing: 1px; 
            text-decoration: none;
            display: flex; 
            align-items: center; 
            gap: 10px;
        }
        .logo i { color: var(--accent-yellow); font-size: 1.8rem; }

        .nav-links { display: flex; gap: 25px; font-weight: 600; align-items: center; }
        .nav-links a { text-decoration: none; color: #555; transition: 0.3s; position: relative; font-size: 1rem; }
        .nav-links a:hover, .nav-links a.active { color: var(--primary-color); }
        .nav-links a::after {
            content: ''; position: absolute; width: 0; height: 3px; bottom: -5px; left: 0;
            background: var(--accent-yellow); transition: width 0.3s; border-radius: 2px;
        }
        .nav-links a:hover::after { width: 100%; }

        .nav-actions { display: flex; align-items: center; gap: 15px; }
        
        .search-box {
            position: relative; 
            background: #f1f2f6; 
            border-radius: 30px; 
            padding: 5px 15px;
            display: flex; 
            align-items: center; 
            border: 2px solid transparent; 
            transition: 0.3s;
        }
        .search-box:focus-within { border-color: var(--primary-color); background: #fff; }
        .search-box input {
            border: none; background: transparent; outline: none; padding: 5px; width: 150px; 
            color: #333; font-size: 0.9rem;
        }
        .search-box i { color: #aaa; }

        .icon-btn { font-size: 1.2rem; color: #555; cursor: pointer; position: relative; transition: 0.3s; }
        .icon-btn:hover { color: var(--primary-color); transform: scale(1.1); }
        
        .cart-badge {
            position: absolute; top: -8px; right: -8px; background: var(--accent-pink); color: white;
            font-size: 0.7rem; width: 18px; height: 18px; border-radius: 50%; display: flex; 
            justify-content: center; align-items: center; font-weight: bold;
        }

        .btn-login {
            background: var(--primary-color); color: white; border: none; padding: 8px 20px; 
            border-radius: 20px; font-weight: bold; cursor: pointer; transition: 0.3s;
            box-shadow: 0 4px 10px rgba(0, 168, 255, 0.3);
        }
        .btn-login:hover { background: var(--primary-dark); transform: translateY(-2px); }

        /* --- HERO SECTION --- */
        .hero { text-align: center; padding: 60px 20px 40px; }
        .hero h1 {
            font-size: 3rem; color: var(--primary-color); text-shadow: 3px 3px 0px #fff; 
            margin-bottom: 10px;
        }
        .hero p { background: #fff; display: inline-block; padding: 5px 20px; border-radius: 20px; color: #666; font-weight: 600; box-shadow: 0 5px 15px rgba(0,0,0,0.05); }

        /* --- MAIN CONTAINER & GRID --- */
        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
        h2 { border-left: 8px solid var(--accent-yellow); padding-left: 20px; margin: 30px 0; text-transform: uppercase; color: var(--primary-color); font-weight: 800; }
        
        .game-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 30px; }
        
        .game-card {
            background: var(--card-bg); border-radius: 20px; overflow: hidden; transition: all 0.3s;
            box-shadow: 0 10px 25px rgba(0, 168, 255, 0.15); position: relative;
            border: 2px solid transparent; display: flex; flex-direction: column;
        }
        .game-card:hover { transform: translateY(-10px); border-color: var(--accent-yellow); }
        
        .price-tag { position: absolute; top: 15px; right: 15px; background: var(--accent-pink); color: #fff; padding: 5px 12px; border-radius: 20px; font-weight: bold; font-size: 0.85rem; z-index: 2; }
        .price-tag.free { background: var(--primary-color); }
        
        .game-thumb { width: 100%; height: 180px; overflow: hidden; }
        .game-thumb img { width: 100%; height: 100%; object-fit: cover; display: block; transition: transform 0.3s; }
        .game-card:hover .game-thumb img { transform: scale(1.05); }

        .game-info { padding: 20px; flex-grow: 1; display: flex; flex-direction: column; }
        .game-title { font-size: 1.3rem; color: var(--primary-color); margin-bottom: 5px; font-weight: 700; }
        .game-desc { font-size: 0.9rem; color: #666; margin-bottom: 15px; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
        
        .btn-play { width: 100%; padding: 10px; background: var(--accent-yellow); color: #2c3e50; border: none; border-radius: 30px; font-weight: 800; cursor: pointer; transition: 0.2s; box-shadow: 0 3px 0 #e1b12c; margin-top: auto; }
        .btn-play:hover { background: #fcd567; transform: translateY(-2px); }
        .btn-play:active { transform: translateY(2px); box-shadow: none; }

        .bank-info-display { background: #f0f9ff; padding: 10px; margin-top: 10px; border-radius: 8px; font-size: 0.85rem; color: #555; border-left: 3px solid var(--primary-color); display: none; }
        .show-bank { display: block; }

        /* --- FORM UPLOAD --- */
        .upload-section { background: #fff; padding: 30px; border-radius: 20px; margin-top: 50px; box-shadow: 0 10px 30px rgba(0,0,0,0.05); }
        .form-row { display: flex; gap: 20px; margin-bottom: 15px; }
        .form-col { flex: 1; }
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; color: var(--primary-color); font-weight: 700; }
        input, textarea { width: 100%; padding: 12px; border-radius: 10px; border: 1px solid #ddd; background: #f9f9f9; outline: none; }
        input:focus, textarea:focus { border-color: var(--primary-color); background: #fff; }

        /* --- FOOTER --- */
        footer { text-align: center; padding: 40px; margin-top: 60px; color: #fff; background: var(--primary-color); font-weight: bold; }

        /* --- DETAIL PAGE STYLES --- */
        .detail-header { text-align: left; padding-top: 20px; margin-bottom: 30px; }
        .detail-header h1 { font-size: 3rem; color: var(--text-color); text-shadow: none; margin-bottom: 5px; }
        .detail-header p { background: var(--card-bg); padding: 5px 10px; border-radius: 10px; color: #555; font-weight: 600; display: inline-block; }

        .detail-grid { display: grid; grid-template-columns: 2fr 1fr; gap: 30px; align-items: start; }
        .video-player { width: 100%; height: 450px; background: #000; border-radius: 15px; overflow: hidden; box-shadow: 0 10px 20px rgba(0,0,0,0.2); position: relative; }
        .video-player iframe { width: 100%; height: 100%; border: none; }

        .game-specs { background: var(--card-bg); padding: 30px; border-radius: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        .game-specs h3 { color: var(--primary-dark); margin-bottom: 15px; border-bottom: 3px solid var(--accent-yellow); padding-bottom: 5px; }
        .spec-item { margin-bottom: 10px; font-size: 0.95rem; }
        .spec-item strong { color: var(--text-color); display: inline-block; width: 110px; }
        
        .story-section { margin-top: 30px; }
        /* CSS cho ph·∫ßn n·ªôi dung chi ti·∫øt ƒë·ªông */
        .story-box { background: var(--card-bg); padding: 25px; border-radius: 15px; margin-top: 15px; color: #333; line-height: 1.8; box-shadow: 0 5px 15px rgba(0,0,0,0.05); }
        .gameplay-box { background: var(--card-bg); padding: 25px; border-radius: 15px; margin-top: 15px; color: #333; box-shadow: 0 5px 15px rgba(0,0,0,0.05); }
        .win-loss-list { list-style: none; padding-left: 0; margin-top: 15px; }
        .win-loss-list li { margin-bottom: 10px; display: flex; align-items: flex-start; gap: 10px; }
        .purchase-note { background: #fff3cd; color: #856404; padding: 15px; border-radius: 10px; margin-top: 20px; border: 1px solid #ffeeba; display: flex; align-items: center; gap: 10px; }

        /* --- RESPONSIVE --- */
        @media (max-width: 900px) {
            .detail-grid { grid-template-columns: 1fr; }
            .video-player { height: 300px; }
        }
        @media (max-width: 768px) {
            .navbar { flex-direction: column; gap: 15px; padding: 15px; }
            .nav-links { gap: 15px; font-size: 0.9rem; width: 100%; justify-content: center; }
            .nav-actions { width: 100%; justify-content: space-between; }
            .search-box input { width: 100%; }
            .form-row { flex-direction: column; gap: 0; }
        }
    </style>
</head>
<body>

    <div id="app-container">
    </div>

    <footer>
        <p>&copy; 2025 Nh√≥m TR√ÄN B·ªò NH·ªö.</p>
    </footer>

    <script>
        // --- 1. D·ªÆ LI·ªÜU GAME (DATABASE) - ƒê√É C·∫¨P NH·∫¨T CHI TI·∫æT ---
        const initialGames = [
            { 
                id: 1, 
                name: "Magician vs. Goblin", 
                desc: "ƒê·∫°i chi·∫øn ·∫£o thu·∫≠t gia v√† qu√°i v·∫≠t Goblin. Game nh·∫≠p vai h√†nh ƒë·ªông.", 
                price: 50000, 
                bankInfo: "999999 - Techcombank - VO MINH TRIET", 
                img: "GameImage/game1.png", 
                genre: "RPG, Action", 
                players: "Single", 
                developer: "V√µ Minh Tri·∫øt", 
                release: "07/11/2025", 
                videoUrl: "https://www.youtube.com/embed/dQw4w9WgXcQ?autoplay=1&mute=1",
                story: "V∆∞∆°ng qu·ªëc Magic b·ªã lo√†i Goblin x√¢m chi·∫øm. B·∫°n l√† h·∫≠u du·ªá cu·ªëi c√πng c·ªßa d√≤ng t·ªôc Ph√°p s∆∞ T·ªëi th∆∞·ª£ng. H√£y s·ª≠ d·ª•ng quy·ªÅn nƒÉng c·ªßa m√¨nh ƒë·ªÉ b·∫£o v·ªá vi√™n ƒë√° Mana.",
                gameplay: "S·ª≠ d·ª•ng WASD ƒë·ªÉ di chuy·ªÉn. Chu·ªôt tr√°i ƒë·ªÉ b·∫Øn c·∫ßu l·ª≠a, Chu·ªôt ph·∫£i ƒë·ªÉ d√πng l√° ch·∫Øn.",
                winCondition: "Ti√™u di·ªát Goblin Lord ·ªü m√†n 10.",
                lossCondition: "Thanh m√°u v·ªÅ 0 ho·∫∑c Nh√† ch√≠nh b·ªã ph√° h·ªßy."
            },
            { 
                id: 2, 
                name: "Sinh Vi√™n sinh t·ªìn", 
                desc: "S·ªëng s√≥t qua 30 ng√†y c√πng nh·ªØng bi·∫øn c·ªë b·∫•t ng·ªù th·ªùi Sinh vi√™n.", 
                price: 0, 
                bankInfo: "", 
                img: "GameImage/game2.png", 
                genre: "2D Simulator", 
                players: "Single/Multi", 
                developer: "V√µ Ng·ªçc B·∫£o Tr√¢n", 
                release: "08/11/2025", 
                videoUrl: "https://www.youtube.com/embed/aPgpJMc6mfU?autoplay=1&mute=1",
                story: "√ù t∆∞·ªüng c·ªët l√µi c·ªßa tr√≤ ch∆°i l√† m√¥ ph·ªèng l·∫°i cu·ªôc chi·∫øn sinh t·ªìn ƒë√¥ th·ªã c·ªßa m·ªôt sinh vi√™n nƒÉm nh·∫•t t·∫°i Vi·ªát Nam. Ng∆∞·ªùi ch∆°i ph·∫£i s·ªëng s√≥t qua 30 ng√†y v·ªõi ng√¢n s√°ch h·∫°n h·∫πp, li√™n t·ª•c qu·∫£n l√Ω v√† c√¢n b·∫±ng 4 ch·ªâ s·ªë sinh m·ªánh: Ti·ªÅn, S·ª©c kh·ªèe, ƒê·ªô no, v√† Stress. B·ªëi c·∫£nh game t·∫≠p trung v√†o nh·ªØng ƒë·ªãa ƒëi·ªÉm quen thu·ªôc (ph√≤ng tr·ªç, qu√°n c∆°m b√¨nh d√¢n, gi·∫£ng ƒë∆∞·ªùng), n∆°i ng∆∞·ªùi ch∆°i ƒë·ªëi m·∫∑t v·ªõi c√°c s·ª± ki·ªán ng·∫´u nhi√™n mang t√≠nh may r·ªßi cao (deadline g·∫•p, h∆∞ xe, tr√∫ng th∆∞·ªüng). To√†n b·ªô c√¢u chuy·ªán ƒë∆∞·ª£c truy·ªÅn t·∫£i qua c√°c l·ª±a ch·ªçn d·ª±a tr√™n vƒÉn b·∫£n. M·ª•c ti√™u l√† ƒë·∫°t ƒë·∫øn Ng√†y 30 m√† kh√¥ng ƒë·ªÉ b·∫•t k·ª≥ 3 ch·ªâ s·ªë Ti·ªÅn, S·ª©c kh·ªèe, ƒê·ªô no (<=0) ho·∫∑c Stress (>=100).
",
                gameplay: "Click ƒë·ªÉ ch·ªçn h√†nh ƒë·ªông h√†ng ng√†y (ƒêi l√†m, ƒêi h·ªçc, Ng·ªß). C√¢n b·∫±ng ch·ªâ s·ªë S·ª©c kh·ªèe, Ti·ªÅn v√† ƒêi·ªÉm s·ªë.",
                winCondition: "S·ªëng s√≥t qua ng√†y 30 m√† kh√¥ng b·ªã n·ª£ m√¥n.",
                lossCondition: "Ch·ªâ s·ªë Ti·ªÅn ho·∫∑c S·ª©c kh·ªèe v·ªÅ 0."
            },
            { 
                id: 3, 
                name: "Anya's Neo Dodger", 
                desc: "N√© tr√°nh b√†i t·∫≠p Vi T√≠ch Ph√¢n trong th·∫ø gi·ªõi Neon c√πng ANYA.", 
                price: 0, 
                bankInfo: "", 
                img: "GameImage/game3.png", 
                genre: "Arcade, Endless", 
                players: "Single", 
                developer: "Nguy·ªÖn L√™ Ch√≠ T∆∞·ªùng", 
                release: "09/11/2025", 
                videoUrl: "https://www.youtube.com/embed/n4yK54iF55g?autoplay=1&mute=1",
                story: "Anya l·∫°c v√†o th·∫ø gi·ªõi Cyberpunk nh∆∞ng l·∫°i b·ªã c√°c c√¥ng th·ª©c To√°n cao c·∫•p truy ƒëu·ªïi.",
                gameplay: "D√πng ph√≠m m≈©i t√™n ƒë·ªÉ di chuy·ªÉn Anya n√© c√°c k√Ω hi·ªáu t√≠ch ph√¢n r∆°i t·ª´ tr√™n xu·ªëng.",
                winCondition: "ƒê·∫°t 1000 ƒëi·ªÉm Highscore.",
                lossCondition: "Va ch·∫°m v·ªõi b·∫•t k·ª≥ c√¥ng th·ª©c to√°n n√†o."
            },
            { 
                id: 4, 
                name: "ERROR RUN", 
                desc: "Ch·∫°y tr·ªën m√†n h√¨nh xanh ch·∫øt ch√≥c g·ªìm BUG v√† ERROR.", 
                price: 20000, 
                bankInfo: "777777 - ACB - VO NGUYEN CONG TRI", 
                img: "GameImage/game4.png", 
                genre: "Endless, Horror", 
                players: "Single", 
                developer: "V√µ Nguy·ªÖn C√¥ng Tr√≠", 
                release: "10/11/2025", 
                videoUrl: "https://www.youtube.com/embed/aPgpJMc6mfU?autoplay=1&mute=1",
                story: "B·∫°n l√† m·ªôt file d·ªØ li·ªáu quan tr·ªçng ƒëang c·ªë g·∫Øng tho√°t kh·ªèi s·ª± truy qu√©t c·ªßa Virus M√†n H√¨nh Xanh.",
                gameplay: "Ch·∫°y kh√¥ng ng·ª´ng ngh·ªâ (Endless Run). Nh·∫•n Space ƒë·ªÉ nh·∫£y qua c√°c ƒëo·∫°n m√£ l·ªói (Bug).",
                winCondition: "Kh√¥ng c√≥ ƒë√≠ch ƒë·∫øn, s·ªëng c√†ng l√¢u c√†ng t·ªët.",
                lossCondition: "B·ªã Bug b·∫Øt k·ªãp ho·∫∑c r∆°i xu·ªëng h·ªë d·ªØ li·ªáu."
            },
            { 
                id: 5, 
                name: "Naruto Adventure", 
                desc: "Nhi·ªám v·ª• Ninja c·∫•p S c√πng Kakashi(?) v√† Naruto.", 
                price: 0, 
                bankInfo: "", 
                img: "GameImage/game5.png", 
                genre: "Adventure, Fighting", 
                players: "Single", 
                developer: "ƒê·ªó Duy Tr∆∞·ªùng", 
                release: "11/11/2025", 
                videoUrl: "https://www.youtube.com/embed/dQw4w9WgXcQ?autoplay=1&mute=1",
                story: "C√πng Naruto th·ª±c hi·ªán nhi·ªám v·ª• b√≠ m·∫≠t t·∫°i L√†ng M∆∞a. ƒê·ªëi ƒë·∫ßu v·ªõi c√°c th√†nh vi√™n Akatsuki.",
                gameplay: "Combo k·ªπ nƒÉng Q, W, E, R ƒë·ªÉ t·∫•n c√¥ng ƒë·ªëi th·ªß. F ƒë·ªÉ l∆∞·ªõt n√© ƒë√≤n.",
                winCondition: "ƒê√°nh b·∫°i Pain.",
                lossCondition: "H·∫øt m√°u."
            },
            { 
                id: 6, 
                name: "D·∫°o Ph·ªë CHILL", 
                desc: "L√°i xe th∆∞ gi√£n c√πng nh·∫°c Lofi trong th·∫ø gi·ªõi si√™u th·ª±c.", 
                price: 100000, 
                bankInfo: "111111 - Vietcombank - DOAN HOANG VIET", 
                img: "GameImage/game6.png", 
                genre: "Simulation, Relax", 
                players: "Single", 
                developer: "ƒêo√†n Ho√†ng Vi·ªát", 
                release: "12/10/2025", 
                videoUrl: "https://www.youtube.com/embed/n4yK54iF55g?autoplay=1&mute=1",
                story: "Kh√¥ng c√≥ k·∫ª th√π, kh√¥ng √°p l·ª±c. Ch·ªâ c√≥ b·∫°n, chi·∫øc xe v√† √¢m nh·∫°c trong th√†nh ph·ªë v·ªÅ ƒë√™m.",
                gameplay: "L√°i xe t·ª± do kh√°m ph√° th√†nh ph·ªë. B·∫•m M ƒë·ªÉ ƒë·ªïi b√†i h√°t.",
                winCondition: "Kh√¥ng c√≥, game ch·ªâ ƒë·ªÉ th∆∞ gi√£n.",
                lossCondition: "Kh√¥ng c√≥."
            }
        ];

        let currentGames = [...initialGames];
        const appContainer = document.getElementById('app-container');
        const formatter = new Intl.NumberFormat('vi-VN', { style: 'currency', currency: 'VND' });

        // --- 2. H√ÄM RENDER TRANG CH·ª¶ (HOMEPAGE) ---
        function renderHomePage() {
            appContainer.innerHTML = `
                <nav class="navbar">
                    <a class="logo" href="about.html" target="_blank">
                        <i class="fa-solid fa-gamepad"></i> TBN STUDIO
                    </a>
                    
                    <div class="nav-links">
                        <a href="#" class="active">Trang ch·ªß</a>
                        <a href="#gallery-title">Kh√°m ph√°</a>
                        <a href="#">Th·ªÉ lo·∫°i <i class="fa-solid fa-caret-down" style="font-size: 0.8rem;"></i></a>
                        <a href="#">C·ªông ƒë·ªìng</a>
                        <a href="#uploadForm" id="uploadNavBtn" style="color:#00a8ff;font-weight:bold;">
                            <i class="fa-solid fa-upload"></i> ƒêƒÉng t·∫£i game
                        </a>
                    </div>

                    <div class="nav-actions">
                        <div class="search-box">
                            <input type="text" id="searchInput" placeholder="T√¨m game...">
                            <i class="fa-solid fa-magnifying-glass"></i>
                        </div>
                        <div class="icon-btn" onclick="alert('Gi·ªè h√†ng c·ªßa b·∫°n ƒëang tr·ªëng!')">
                            <i class="fa-solid fa-cart-shopping"></i>
                            <span class="cart-badge">0</span>
                        </div>
                        <button class="btn-login" onclick="alert('Ch·ª©c nƒÉng ƒëƒÉng nh·∫≠p ƒëang b·∫£o tr√¨!')">ƒêƒÉng nh·∫≠p</button>
                    </div>
                </nav>

                <div class="hero">
                    <h1>TR√ÄN B·ªò NH·ªö</h1>
                    <p>‚ú® H·ªôi ch·ª£ Game Indie - N∆°i √Ω t∆∞·ªüng th√†nh hi·ªán th·ª±c ‚ú®</p>
                </div>

                <div class="container">
                    <h2 id="gallery-title">üî• Game ƒê·ªÅ Xu·∫•t</h2>
                    <div class="game-grid" id="gameGrid"></div>

                    <h2>üöÄ ƒêƒÉng Game M·ªõi</h2>
                    <div class="upload-section" id="uploadForm">
                        <form id="uploadFormContent">
                            <div class="form-row">
                                <div class="form-col">
                                    <label>T√™n Game:</label>
                                    <input type="text" id="gName" required placeholder="T√™n game...">
                                </div>
                                <div class="form-col">
                                    <label>Gi√° (VNƒê):</label>
                                    <input type="number" id="gPrice" placeholder="0 = Free">
                                </div>
                            </div>
                            <div class="form-group">
                                <label>M√¥ t·∫£:</label>
                                <textarea id="gDesc" rows="2" required placeholder="M√¥ t·∫£ ng·∫Øn v·ªÅ game..."></textarea>
                            </div>
                            <div class="form-group">
                                <label>Th√¥ng tin Bank (N·∫øu b√°n):</label>
                                <textarea id="gBank" rows="1" placeholder="STK nh·∫≠n ti·ªÅn..."></textarea>
                            </div>
                            <div class="form-group">
                                <label>·∫¢nh b√¨a:</label>
                                <input type="file" id="gImage" accept="image/*" required>
                            </div>
                            <button type="submit" class="btn-play" style="width: 200px; margin: 0 auto; display: block;">ƒêƒÉng ngay</button>
                        </form>
                    </div>
                </div>
            `;
            
            const gameGrid = document.getElementById('gameGrid');
            const uploadForm = document.getElementById('uploadFormContent');
            const searchInput = document.getElementById('searchInput');
            const uploadNavBtn = document.getElementById("uploadNavBtn");

            renderGames(currentGames, gameGrid);
            
            uploadNavBtn.addEventListener("click", function(e){
                e.preventDefault();
                document.getElementById("uploadForm").scrollIntoView({behavior: "smooth"});
            });

            searchInput.addEventListener('input', function(e) {
                const keyword = e.target.value.toLowerCase();
                const filteredGames = currentGames.filter(game => 
                    game.name.toLowerCase().includes(keyword)
                );
                renderGames(filteredGames, gameGrid);
            });

            uploadForm.addEventListener('submit', handleGameUpload);
        }

        function renderGames(games, gridElement) {
            gridElement.innerHTML = "";
            if(games.length === 0) {
                gridElement.innerHTML = "<p style='text-align:center; color:#666; grid-column: 1/-1;'>Kh√¥ng t√¨m th·∫•y game n√†o...</p>";
                return;
            }
            games.forEach(game => {
                const isFree = game.price == 0;
                const priceDisplay = isFree ? "FREE" : formatter.format(game.price);
                const priceClass = isFree ? "free" : "";
                const bankDisplayClass = (!isFree && game.bankInfo) ? "show-bank" : "";

                const card = document.createElement('div');
                card.className = 'game-card';
                card.innerHTML = `
                    <div class="price-tag ${priceClass}">${priceDisplay}</div>
                    <div class="game-thumb"><img src="${game.img}" alt="${game.name}"></div>
                    <div class="game-info">
                        <h3 class="game-title">${game.name}</h3>
                        <p class="game-desc">${game.desc}</p>
                        <div class="bank-info-display ${bankDisplayClass}">üí≥ CK: ${game.bankInfo}</div>
                        <button onclick="openGameDetail(${game.id})" class="btn-play">
                            ${isFree ? 'CH∆†I NGAY' : 'MUA NGAY'}
                        </button>
                    </div>
                `;
                gridElement.appendChild(card);
            });
        }
        
        function handleGameUpload(e) {
            e.preventDefault();
            const name = document.getElementById('gName').value;
            const desc = document.getElementById('gDesc').value;
            const price = parseInt(document.getElementById('gPrice').value) || 0;
            const bank = document.getElementById('gBank').value;
            const fileInput = document.getElementById('gImage');
            
            if (fileInput.files && fileInput.files[0]) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const newGame = {
                        id: Date.now(), name: name, desc: desc, price: price, bankInfo: bank,
                        img: e.target.result, 
                        genre: "Indie", players: "1", developer: "C·ªông ƒë·ªìng", release: new Date().toLocaleDateString('vi-VN'),
                        videoUrl: "https://www.youtube.com/embed/n4yK54iF55g?autoplay=1&mute=1",
                        // Th√™m d·ªØ li·ªáu m·∫∑c ƒë·ªãnh cho game m·ªõi upload ƒë·ªÉ kh√¥ng b·ªã l·ªói hi·ªÉn th·ªã
                        story: "N·ªôi dung ƒëang ƒë∆∞·ª£c t√°c gi·∫£ c·∫≠p nh·∫≠t...",
                        gameplay: "Li√™n h·ªá t√°c gi·∫£ ƒë·ªÉ bi·∫øt th√™m chi ti·∫øt.",
                        winCondition: "Ch∆∞a x√°c ƒë·ªãnh.",
                        lossCondition: "Ch∆∞a x√°c ƒë·ªãnh."
                    };
                    currentGames.unshift(newGame);
                    renderHomePage(); 
                    alert("ƒêƒÉng t·∫£i game th√†nh c√¥ng!");
                }
                reader.readAsDataURL(fileInput.files[0]);
            }
        }


        // --- 3. H√ÄM RENDER CHI TI·∫æT GAME (DETAIL PAGE) - ƒê√É C·∫¨P NH·∫¨T ---
        function openGameDetail(gameId) {
            window.open(`${window.location.pathname}?game=${gameId}`, '_blank');
        }

        function getQueryParam(param) {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(param);
        }
        
        function renderDetailPage(game) {
            const isFree = game.price == 0;
            const priceDisplay = isFree ? "FREE" : formatter.format(game.price);

            // Fallback n·∫øu thi·∫øu d·ªØ li·ªáu
            const storyText = game.story || "ƒêang c·∫≠p nh·∫≠t...";
            const gameplayText = game.gameplay || "S·ª≠ d·ª•ng b√†n ph√≠m v√† chu·ªôt.";
            const winText = game.winCondition || "Ho√†n th√†nh m·ª•c ti√™u.";
            const lossText = game.lossCondition || "H·∫øt m·∫°ng.";

            appContainer.innerHTML = `
                <nav class="navbar">
                    <a class="logo" href="about.html" target="_blank">
                        <i class="fa-solid fa-gamepad"></i> TBN STUDIO
                    </a>
                    <div class="nav-links">
                        <a href="${window.location.pathname}">Trang ch·ªß</a>
                        <a href="#">Kh√°m ph√°</a>
                    </div>
                </nav>

                <div class="container">
                    <div class="detail-header">
                        <h1>${game.name}</h1>
                        <p>T√°c gi·∫£: ${game.developer}</p>
                        <button onclick="alert('${isFree ? 'B·∫Øt ƒë·∫ßu ch∆°i ngay!' : 'ƒê√£ mua game! Vui l√≤ng chuy·ªÉn kho·∫£n: ' + game.bankInfo}')" 
                                class="btn-play" style="width: 200px; margin-top: 20px; background: ${isFree ? 'var(--primary-color)' : 'var(--accent-pink)'}; box-shadow: 0 3px 0 ${isFree ? 'var(--primary-dark)' : '#d63031'}; color: white;">
                            ${isFree ? 'CH∆†I NGAY' : 'MUA V√Ä T·∫¢I'}
                        </button>
                    </div>

                    <div class="detail-grid">
                        <div class="main-content">
                            <div class="video-player">
                                <iframe src="${game.videoUrl}" allow="autoplay; encrypted-media" allowfullscreen></iframe>
                            </div>

                            <div class="story-section">
                                <h2 style="border-left: 8px solid var(--accent-pink);">üìñ C·ªët truy·ªán & √ù t∆∞·ªüng</h2>
                                <div class="story-box">
                                    <p>${storyText}</p>
                                </div>

                                <h2 style="margin-top: 30px;">üéÆ H∆∞·ªõng d·∫´n ch∆°i</h2>
                                <div class="gameplay-box">
                                    <p><strong>C√°ch ƒëi·ªÅu khi·ªÉn:</strong> ${gameplayText}</p>
                                    
                                    <ul class="win-loss-list">
                                        <li>
                                            <i class="fa-solid fa-trophy" style="color: gold; font-size: 1.2rem;"></i> 
                                            <strong>Th·∫Øng:</strong> ${winText}
                                        </li>
                                        <li>
                                            <i class="fa-solid fa-skull" style="color: #ff7675; font-size: 1.2rem;"></i> 
                                            <strong>Thua:</strong> ${lossText}
                                        </li>
                                    </ul>
                                </div>
                                
                                ${!isFree ? `
                                <div class="purchase-note">
                                    <i class="fa-solid fa-triangle-exclamation" style="font-size: 1.5rem;"></i>
                                    <div>
                                        <strong>L∆∞u √Ω mua game:</strong><br>
                                        Vui l√≤ng chuy·ªÉn kho·∫£n s·ªë ti·ªÅn <strong>${priceDisplay}</strong> ƒë·∫øn STK: <strong>${game.bankInfo}</strong>.
                                    </div>
                                </div>` : ''}
                            </div>
                        </div>

                        <div class="game-specs">
                            <h3>üîç Th√¥ng s·ªë k·ªπ thu·∫≠t</h3>
                            <div class="spec-item"><strong>Th·ªÉ lo·∫°i:</strong> <span>${game.genre}</span></div>
                            <div class="spec-item"><strong>S·ªë ng∆∞·ªùi ch∆°i:</strong> <span>${game.players}</span></div>
                            <div class="spec-item"><strong>Ph√°t tri·ªÉn b·ªüi:</strong> <span>${game.developer}</span></div>
                            <div class="spec-item"><strong>Ng√†y ƒëƒÉng t·∫£i:</strong> <span>${game.release}</span></div>
                            <div class="spec-item"><strong>Gi√° ti·ªÅn:</strong> <span style="color: var(--accent-pink); font-weight:bold;">${priceDisplay}</span></div>
                            <div class="spec-item" style="margin-top:15px; border-top:1px solid #eee; padding-top:10px;">
                                <strong>M√¥ t·∫£ ng·∫Øn:</strong> <br> <i style="font-size: 0.9rem; color: #666;">${game.desc}</i>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            document.title = `${game.name} - Chi ti·∫øt | TBN Studio`;
        }

        // --- 4. KH·ªûI CH·∫†Y (MAIN) ---
        document.addEventListener('DOMContentLoaded', function() {
            const gameId = getQueryParam('game');
            if (gameId) {
                const selectedGame = currentGames.find(g => g.id == gameId);
                selectedGame ? renderDetailPage(selectedGame) : (alert("Game kh√¥ng t·ªìn t·∫°i!"), renderHomePage());
            } else {
                renderHomePage();
            }
        });
    </script>
</body>
</html>
